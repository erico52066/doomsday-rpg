<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>末蝕紀元 v0.72 改良版</title>
    <meta name="description" content="在末世中生存，探索廢土，建立你的傳奇故事。">
    <!-- Browser tab icon -->
    <link rel="icon" href="data/images/icon.png">

    <!-- Open Graph Meta Tags -->
    <meta property="og:url" content="https://erico52066.github.io/doomsday-rpg/">
    <meta property="og:type" content="application">
    <meta property="og:site_name" content="末蝕紀元">
    <meta property="og:image" content="https://erico52066.github.io/doomsday-rpg/data/images/thumbnail.png">
    <meta property="og:title" content="末蝕紀元 v0.72 改良版">
    <meta property="og:description" content="在末世中生存，探索廢土">

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="erico52066.github.io">
    <meta property="twitter:url" content="https://erico52066.github.io/doomsday-rpg/">
    <meta name="twitter:title" content="末蝕紀元 v0.72 改良版">
    <meta name="twitter:description" content="在末世中生存，探索廢土">
    <meta name="twitter:image" content="https://erico52066.github.io/doomsday-rpg/data/images/doomsday.png">

    <meta name="theme-color" content="#ffaa00">
    <link rel="stylesheet" href="style.css" />
    <script type="module" src="./GameData.js"></script>
    <script type="module" src="./GameMain.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.15.2/dist/cdn.min.js"></script>
</head>
<body x-data="Global">
    <div id="game-container" style="display:none">
        <div id="weather-bar">
            <span id="w-text">☀️ 晴朗</span></span>
            <button id="quest-btn" type="button" onclick="showQuestDetail()">📜 任務資訊</button>
            <span><span id="v-job" style="color:var(--r-rare)"></span> / <span id="v-mbti" class="c-mbti"></span> <span id="v-status-extra" style="color:#f44"></span></span>
        </div>

        <div id="header">
            <button id="stat-btn" type="button" onclick="collapseStat()">🔽 現在資訊</button>
            <div id="stat-bar">
                <div class="stat-box"><span class="stat-lbl">Day</span><span class="stat-val" id="v-day">0</span></div>
                <div class="stat-box"><span class="stat-lbl">HP</span><span class="stat-val" style="color:var(--hp-color)"><span id="v-hp">100</span>/<span id="v-max-hp">100</span></span></div>
                <div class="stat-box"><span class="stat-lbl">SAN</span><span class="stat-val" style="color:var(--san-color)" id="v-san">100</span></div>
                <div class="stat-box" onclick="showStats()"><span class="stat-lbl">Lv. <span id="v-lvl" style="color:#fff">1</span></span><span class="stat-val" id="v-stats">屬性</span></div>
                <div class="stat-box"><span class="stat-lbl">XP</span><span class="stat-val" id="v-xp" style="color:var(--xp-color)">0/20</span></div>
                <div class="stat-box"><span class="stat-lbl">物資</span><span class="stat-val"><span id="v-food-icon">🍖</span><span id="v-food">100</span>/<span id="v-water-icon">💧</span><span id="v-water">100</span></span></div>
                <div class="stat-box"><span class="stat-lbl">💰 金錢</span><span class="stat-val" id="v-money" style="color:#ffd700">0</span></div>
            </div>
        </div>
        
        <div id="equip-bar">
            <button id="equip-btn" type="button" onclick="collapseEquip()">🔽 裝備</button>
            <div id="equip-container">
                <div class="eq-row" onclick="showItemDetail('melee')">
                    <span class="eq-label">⚔️ 近戰</span><span id="eq-melee" class="eq-val q0">(未裝備)</span>
                    <div id="tag-melee" class="mastery-tag" style="display:none">專精</div>
                </div>
                <div class="eq-row" onclick="showItemDetail('ranged')">
                    <span class="eq-label">🔫 遠程</span><span class="eq-val"><span id="eq-ranged" class="q0">(未裝備)</span> <span id="v-ammo" style="color:#666;font-size:0.8em;font-weight:normal">(0)</span></span>
                    <div id="tag-ranged" class="mastery-tag" style="display:none">專精</div>
                </div>
                <div class="eq-row" onclick="showItemDetail('head')"><span class="eq-label">🪖 頭部</span><span id="eq-head" class="eq-val q0">(未裝備)</span></div>
                <div class="eq-row" onclick="showItemDetail('body')"><span class="eq-label">👕 身體</span><span id="eq-body" class="eq-val q0">(未裝備)</span></div>
                <div class="eq-row" onclick="showItemDetail('acc')"><span class="eq-label">💍 飾品</span><span id="eq-acc" class="eq-val q0">(未裝備)</span></div>
                <div class="eq-row" onclick="showItemDetail('shoes')"><span class="eq-label">👢 足部</span><span id="eq-shoes" class="eq-val q0">(未裝備)</span></div>
            </div>
        </div>

    <!-- ★★★敵人專屬區域 ★★★ -->
        <div id="enemy-area" style="display:none"></div>

        <div id="log-area"></div>
        <div id="action-area"></div>
    </div>

    <!-- Modal -->
    <div id="screen-modal" class="overlay" style="display:none" >
        <div id="modal-content" onclick="event.stopPropagation()">
            <h2 id="m-title" style="margin:0 0 10px 0; color:#fff"></h2>
            <div id="m-desc" style="color:#ccc; line-height:1.6; font-size:0.95em"></div>
            <div id="m-btns" style="margin-top:15px"></div>
        </div>
    </div>

    <!-- Start Screens -->
    <div id="screen-start" class="overlay" x-show="$store.ui.showStart" style="display: none;">
        <h1 style="color:var(--r-legend); font-size: 2.5em; text-transform: uppercase; margin-bottom:10px; text-shadow: 0 0 20px rgba(255,170,0,0.5);">末蝕紀元 v0.72 改良版</h1>
        <p style="color:#888; margin-bottom: 20px;" x-text="updateLog"></p>
        <div style="display:flex; gap:10px;" >
            <button type="button" @click="startGame(1)" style="width:120px;text-align:center">🟢 歡快模式</button>
            <button type="button" x-bind="startGame(2)" style="width:120px;text-align:center;border-color:var(--r-rare)">🟡 標准模式</button>
            <button type="button" x-bind="startGame(3)" style="width:120px;text-align:center;border-color:var(--r-legend)">🔴 挑戰模式</button>
        </div>
    </div>

    <div id="screen-jobs" class="overlay" x-show="$store.ui.showJobSelection" style="display:none; flex-direction:column; justify-content:flex-start; padding-top:5vh;"> 
    <!-- 標題區 -->
    <div style="text-align:center; margin-bottom:15px;">
        <h2 style="color:#ccc; margin:0 0 10px 0;">Step 1: 選擇前世身份</h2>
        <p style="color:#888; font-size:0.9em; margin:0;">請選擇一個戰鬥風格以查看詳細職業</p>
    </div>

    <!-- 1. 固定不消失的分類按鈕列 -->
    <div id="tab-container" style="display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap; justify-content:center;">
        <!-- 注意：onclick 傳入的參數對應 RPG_CLASSES 的 key -->
        <button id="tab-warrior" onclick="renderJobs('warrior')" style="border-color:#d96; min-width:80px;">🛡️ 鐵衛</button>
        <button id="tab-berserker" onclick="renderJobs('berserker')" style="border-color:#f44; min-width:80px;">⚔️ 狂戰</button>
        <button id="tab-ranger" onclick="renderJobs('ranger')" style="border-color:#4f4; min-width:80px;">🏹 遊俠</button>
        <button id="tab-mage" onclick="renderJobs('mage')" style="border-color:#4cf; min-width:80px;">🔮 秘法</button>
        <button id="tab-special" onclick="renderJobs('special')" style="border-color:#ffd700; min-width:80px;">🦄 特殊</button>
    </div>

    <!-- 2. 角色卡片顯示區 (這裡只會顯示當前選中分類的角色) -->
    <div id="job-container" class="btn-grid" style="
        width: 95%; 
        max-width: 1000px; 
        max-height: 65vh; 
        overflow-y: auto; 
        display: flex; 
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); 
        gap: 15px; 
        padding: 5px;
        align-content: start;
        justify-content: center;">
            <div x-show="$store.ui.showJobIntros" style="text-align:center; padding:20px; color:#aaa;">
                <h3 style="margin-bottom:20px; color:#fff;">請點擊上方按鈕選擇系別</h3>
                <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:15px; text-align:left; width:100%; max-width:600px;">
                    <div style="border-left:3px solid #aaa; padding-left:10px;">
                        <strong style="color:#d96">🛡️ 鐵衛</strong><br>
                        <span style="font-size:0.8em">高生存、防禦、格擋、回血。</span>
                    </div>
                    <div style="border-left:3px solid #f44; padding-left:10px;">
                        <strong style="color:#f44">⚔️ 狂戰</strong><br>
                        <span style="font-size:0.8em">高爆發、以血換血、燃燒。</span>
                    </div>
                    <div style="border-left:3px solid #4f4; padding-left:10px;">
                        <strong style="color:#4f4">🏹 遊俠</strong><br>
                        <span style="font-size:0.8em">高敏捷、閃避、暴擊、連擊。</span>
                    </div>
                    <div style="border-left:3px solid #4cf; padding-left:10px;">
                        <strong style="color:#4cf">🔮 秘法</strong><br>
                        <span style="font-size:0.8em">高智力、控制(暈/睡)、異常狀態。</span>
                    </div>
                    <div style="border-left:3px solid #ffd700; padding-left:10px;">
                        <strong style="color:#ffd700">🦄 特殊</strong><br>
                        <span style="font-size:0.8em">召喚、金錢攻擊、運氣機制。</span>
                    </div>
                </div>
                <p style="margin-top:30px; font-size:0.9em; color:#666;">點擊上方按鈕即可查看詳細角色數值</p>
            </div>
                <template id="job-template" x-show="$store.ui.showJobs" x-for="info in $store.data.jobs">
                    <div class="comp-box" style="cursor: pointer; text-align: left; border: 1px solid #ff4444; display: flex; flex-direction: column; justify-content: space-between;" :style="{'border-color': info.color}" x-bind="selectJob(info, info.stat)">
            <div>
                <div class="q3" style="font-size:1.1em; margin-bottom:8px; color:#f44; text-shadow:none;" x-text="info.name" :style="{color: info.color}">Cosplayer (Lag)</div>
                <div style="font-size:0.9em; margin-bottom:8px; background:#1a1a1a; padding:4px; border-radius:3px; text-align:center;">
                    <span style="color:#f66" x-text="'力' + info.stat.str">力4</span> 
                    <span style="color:#4f4" x-text="'敏' + info.stat.agi">敏6</span> 
                    <span style="color:#4cf" x-text="'智' + info.stat.int">智8</span> 
                    <span style="color:#f4f" x-text="'意' + info.stat.wil">意5</span>
                </div>
                <div style="font-size:0.85em; color:#ccc; line-height:1.5;" x-text="info.desc">高智商，武器易損壞。</div>
            </div>
            <div style="margin-top:10px; font-size:0.8em; color:#666; text-align:right;" x-text="info.trait">
                特質: 玻璃大炮
            </div>
    </template>
    </div>
</div>
    <div id="screen-mbti" class="overlay" style="display:none" x-show="$store.ui.showMBTI">
        <h2 style="color:#ccc; margin-bottom:20px">Step 2: 選擇人格特質</h2>
        <div id="mbti-container" style="display:flex; gap:20px; flex-wrap:wrap; justify-content:center;">
            <template id="job-template" x-show="$store.ui.showMBTI" x-for="info in $store.data.mbtis">
            <div class="comp-box" style="width: 250px; cursor: pointer;" @click="finishSetup(info)">
                <strong class="c-mbti" x-text="info.id + ' ' + info.name">ENTP 辯論家</strong>
                <br>
                <span style="font-size:0.8em;color:#aaa" x-text="info.desc">聰明好奇，喜歡挑戰風險。</span>
                <br>
                <div style="margin-top:8px;color:#fff;font-size:0.9em" x-text="info.bonusText">敏捷 +2, 智力 +1</div>
            </div>
            </template>
        </div>
    </div>
</body>
</html>
